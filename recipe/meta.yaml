{% set version = "2.4.7" %}

package:
  name: libtool
  version: {{ version }}

source:
  url: http://ftpmirror.gnu.org/libtool/libtool-{{ version }}.tar.gz
  sha256: 04e96c2404ea70c590c546eba4202a4e12722c640016c12b9b2f1ce3d481e9a8
  patches:
    # From: https://bugs.debian.org/cgi-bin/bugreport.cgi?att=1;bug=557388;filename=link-as-needed.patch;msg=5
    # See: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=347650
    # and: https://sigquit.wordpress.com/2011/02/16/why-asneeded-doesnt-work-as-expected-for-your-libraries-on-your-autotools-project/
    - 0001-link-as-needed.patch
    - 0002-apple-silicon.patch
    - 0003-apple-silicon.patch
    # This patch is applied after libtool is installed to avoid needing libtool for building libtool
    # - 0004-apple-silicon.patch
    # Pass -fsanitize to linker, see https://lists.gnu.org/archive/html/libtool/2014-04/msg00026.html
    - 0005-fsanitize.patch

build:
  number: 0
  skip: true  # [win]
  ignore_run_exports:
    - libstdcxx-ng
    - libcxx

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - m4
    - help2man
    - autoconf
    - automake
    - make
    - patch

test:
  requires:
    - {{ compiler('cxx') }}

about:
  home: http://www.gnu.org/software/libtool/
  license: GPL-2.0-or-later
  license_file: COPYING
  summary: The GNU Portable Library Tool
  description: |
    GNU libtool is a generic library support script. Libtool hides the
    complexity of using shared libraries behind a consistent, portable
    interface.
  doc_url: http://www.gnu.org/software/libtool/manual/
  dev_url: http://git.savannah.gnu.org/cgit/libtool.git

extra:
  recipe-maintainers:
    - ocefpaf
    - msarahan
    - jakirkham
    - mingwandroid
    - isuruf
    - saraedum
